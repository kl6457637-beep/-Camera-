"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[992],{8628:function(s,e,n){var a=n(8870),t=n(436),c=n(9379),i=n(5544),l=n(758),r=n.n(l),o=n(6540),d=n(118),u=n(4261),h=n(3651),x=n(3439),m=n(4848);function j(){var s=(0,u.Us)(),e=s.bookings,n=(s.addBooking,s.updateBooking),a=s.isPhotographerMode,j=(0,o.useState)("sent"),N=(0,i.A)(j,2),f=N[0],b=N[1],g=(0,o.useState)("all"),v=(0,i.A)(g,2),S=v[0],p=v[1],E=(0,o.useState)(!0),Y=(0,i.A)(E,2),k=(Y[0],Y[1]);(0,l.useDidShow)(function(){k(!1)});var w=e.filter(function(s){return"all"===S||s.status===S}),y=(w.filter(function(s){return"sent"===f?"cancelled"!==s.status:a||"cancelled"!==s.status}),function(s,a){var t=e.find(function(e){return e.id===s});t&&(n((0,c.A)((0,c.A)({},t),{},{status:a,updatedAt:(new Date).toISOString()})),r().showToast({title:"\u64cd\u4f5c\u6210\u529f",icon:"success"}))});return(0,m.jsxs)(d.Ss,{className:"booking-page",children:[(0,m.jsx)(d.Ss,{className:"page-header",children:(0,m.jsx)(d.EY,{className:"page-title",children:"\u9884\u7ea6\u4e2d\u5fc3"})}),(0,m.jsxs)(d.Ss,{className:"tab-bar",children:[(0,m.jsxs)(d.Ss,{className:"tab-item ".concat("sent"===f?"active":""),onClick:function(){return b("sent")},children:[(0,m.jsx)(d.EY,{className:"tab-text",children:"\u6211\u53d1\u51fa\u7684"}),(0,m.jsx)(d.EY,{className:"tab-badge",children:e.filter(function(s){return"cancelled"!==s.status}).length})]}),(0,m.jsx)(d.Ss,{className:"tab-item ".concat("received"===f?"active":""),onClick:function(){return b("received")},children:(0,m.jsx)(d.EY,{className:"tab-text",children:"\u6211\u6536\u5230\u7684"})})]}),(0,m.jsx)(d.BM,{scrollX:!0,className:"status-filter",children:["all"].concat((0,t.A)(Object.keys(x.jU))).map(function(s){var e;return(0,m.jsx)(d.Ss,{className:"status-tag ".concat(S===s?"active":""),onClick:function(){return p(s)},children:(0,m.jsx)(d.EY,{className:"status-text",children:"all"===s?"\u5168\u90e8":(null===(e=x.jU[s])||void 0===e?void 0:e.text)||s})},s)})}),(0,m.jsx)(d.BM,{className:"booking-list",children:0===w.length?(0,m.jsxs)(d.Ss,{className:"empty-state",children:[(0,m.jsx)(d.EY,{className:"empty-icon",children:"\ud83d\udced"}),(0,m.jsx)(d.EY,{className:"empty-text",children:"\u6682\u65e0\u9884\u7ea6"})]}):w.map(function(s){var e,n,a;return(0,m.jsxs)(d.Ss,{className:"booking-card",children:[(0,m.jsxs)(d.Ss,{className:"card-header",children:[(0,m.jsxs)(d.Ss,{className:"user-info",children:[(0,m.jsx)(d._V,{className:"user-avatar",src:"sent"===f?s.photographerAvatar:"",mode:"aspectFill"}),(0,m.jsxs)(d.Ss,{className:"user-detail",children:[(0,m.jsx)(d.EY,{className:"user-name",children:"sent"===f?s.photographerName:s.clientName}),(0,m.jsx)(d.EY,{className:"user-role",children:"sent"===f?"\u6444\u5f71\u5e08":"\u5ba2\u6237"})]})]}),(0,m.jsx)(d.Ss,{className:"status-badge",style:{backgroundColor:(null===(e=x.jU[s.status])||void 0===e?void 0:e.bgColor)||"#f5f5f5",color:(null===(n=x.jU[s.status])||void 0===n?void 0:n.color)||"#999"},children:(0,m.jsx)(d.EY,{className:"status-label",children:(null===(a=x.jU[s.status])||void 0===a?void 0:a.text)||s.status})})]}),(0,m.jsxs)(d.Ss,{className:"card-body",children:[(0,m.jsxs)(d.Ss,{className:"info-row",children:[(0,m.jsx)(d.EY,{className:"info-icon",children:"\ud83d\udcc5"}),(0,m.jsxs)(d.EY,{className:"info-text",children:[s.date," ",s.time]})]}),(0,m.jsxs)(d.Ss,{className:"info-row",children:[(0,m.jsx)(d.EY,{className:"info-icon",children:"\ud83c\udff7\ufe0f"}),(0,m.jsx)(d.EY,{className:"info-text",children:s.type})]}),s.location&&(0,m.jsxs)(d.Ss,{className:"info-row",children:[(0,m.jsx)(d.EY,{className:"info-icon",children:"\ud83d\udccd"}),(0,m.jsx)(d.EY,{className:"info-text",children:s.location})]})]}),(0,m.jsxs)(d.Ss,{className:"card-actions",children:["sent"===f&&"pending"===s.status&&(0,m.jsx)(d.Ss,{className:"action-btn cancel",onClick:function(){return y(s.id,"cancelled")},children:(0,m.jsx)(d.EY,{className:"btn-text",children:"\u53d6\u6d88\u9884\u7ea6"})}),"received"===f&&"pending"===s.status&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(d.Ss,{className:"action-btn secondary",onClick:function(){return r().showToast({title:"\u6c9f\u901a\u529f\u80fd\u5f00\u53d1\u4e2d",icon:"none"})},children:(0,m.jsx)(d.EY,{className:"btn-text",children:"\u6c9f\u901a"})}),(0,m.jsx)(d.Ss,{className:"action-btn danger",onClick:function(){return y(s.id,"cancelled")},children:(0,m.jsx)(d.EY,{className:"btn-text",children:"\u5a49\u62d2"})}),(0,m.jsx)(d.Ss,{className:"action-btn primary",onClick:function(){return y(s.id,"confirmed")},children:(0,m.jsx)(d.EY,{className:"btn-text",children:"\u786e\u8ba4\u9884\u7ea6"})})]}),"received"===f&&"confirmed"===s.status&&(0,m.jsx)(d.Ss,{className:"action-btn primary",onClick:function(){return y(s.id,"shooting")},children:(0,m.jsx)(d.EY,{className:"btn-text",children:"\u5f00\u59cb\u62cd\u6444"})}),"received"===f&&"shooting"===s.status&&(0,m.jsx)(d.Ss,{className:"action-btn primary",onClick:function(){return y(s.id,"review")},children:(0,m.jsx)(d.EY,{className:"btn-text",children:"\u5b8c\u6210\u62cd\u6444"})})]})]},s.id)})}),(0,m.jsx)(h.A,{currentPage:"booking"})]})}var N={},f=(0,a.eU)(j,"pages/booking/index",{root:{cn:[]}},N||{});j&&j.behaviors&&(f.behaviors=(f.behaviors||[]).concat(j.behaviors));Page(f)}},function(s){var e=function(e){return s(s.s=e)};s.O(0,[907,96,76],function(){return e(8628)});s.O()}]);